<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>lab program(temporary post) | SHASHANK</title>
<meta name="keywords" content="">
<meta name="description" content="Table of Contents Program 1 Program 2 Program 3 Program 4 Program 5 Program 6 Program 7 Program 8 Program 9 Program 1 def aStarAlgo(start_node, stop_node): open_set = set([start_node]) closed_set = set() g = {start_node: 0} parents = {start_node: start_node} while len(open_set) &gt; 0: n = None for v in open_set: if n is None or g[v] &#43; heuristic(v) &lt; g[n] &#43; heuristic(n): n = v if n == stop_node or Graph_nodes[n] is None: pass else: for (m, weight) in get_neighbors(n): if m not in open_set and m not in closed_set: open_set.">
<meta name="author" content="">
<link rel="canonical" href="https://shashankmcode.github.io/blog/docs/lab/">
<link crossorigin="anonymous" href="/blog/assets/css/stylesheet.5cfc680b1eeaeef9efbced92d46c2a9e876b72ee14fba85846afc4cff9e6e6f8.css" integrity="sha256-XPxoCx7q7vnvvO2S1Gwqnodrcu4U&#43;6hYRq/Ez/nm5vg=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/blog/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js" integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG&#43;9vmJ0cTS&#43;ovo0FeA="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://shashankmcode.github.io/blog/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://shashankmcode.github.io/blog/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://shashankmcode.github.io/blog/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://shashankmcode.github.io/blog/apple-touch-icon.png">
<link rel="mask-icon" href="https://shashankmcode.github.io/blog/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:title" content="lab program(temporary post)" />
<meta property="og:description" content="Table of Contents Program 1 Program 2 Program 3 Program 4 Program 5 Program 6 Program 7 Program 8 Program 9 Program 1 def aStarAlgo(start_node, stop_node): open_set = set([start_node]) closed_set = set() g = {start_node: 0} parents = {start_node: start_node} while len(open_set) &gt; 0: n = None for v in open_set: if n is None or g[v] &#43; heuristic(v) &lt; g[n] &#43; heuristic(n): n = v if n == stop_node or Graph_nodes[n] is None: pass else: for (m, weight) in get_neighbors(n): if m not in open_set and m not in closed_set: open_set." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://shashankmcode.github.io/blog/docs/lab/" /><meta property="article:section" content="docs" />



<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="lab program(temporary post)"/>
<meta name="twitter:description" content="Table of Contents Program 1 Program 2 Program 3 Program 4 Program 5 Program 6 Program 7 Program 8 Program 9 Program 1 def aStarAlgo(start_node, stop_node): open_set = set([start_node]) closed_set = set() g = {start_node: 0} parents = {start_node: start_node} while len(open_set) &gt; 0: n = None for v in open_set: if n is None or g[v] &#43; heuristic(v) &lt; g[n] &#43; heuristic(n): n = v if n == stop_node or Graph_nodes[n] is None: pass else: for (m, weight) in get_neighbors(n): if m not in open_set and m not in closed_set: open_set."/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Docs",
      "item": "https://shashankmcode.github.io/blog/docs/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "lab program(temporary post)",
      "item": "https://shashankmcode.github.io/blog/docs/lab/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "lab program(temporary post)",
  "name": "lab program(temporary post)",
  "description": "Table of Contents Program 1 Program 2 Program 3 Program 4 Program 5 Program 6 Program 7 Program 8 Program 9 Program 1 def aStarAlgo(start_node, stop_node): open_set = set([start_node]) closed_set = set() g = {start_node: 0} parents = {start_node: start_node} while len(open_set) \u0026gt; 0: n = None for v in open_set: if n is None or g[v] + heuristic(v) \u0026lt; g[n] + heuristic(n): n = v if n == stop_node or Graph_nodes[n] is None: pass else: for (m, weight) in get_neighbors(n): if m not in open_set and m not in closed_set: open_set.",
  "keywords": [
    
  ],
  "articleBody": "Table of Contents Program 1 Program 2 Program 3 Program 4 Program 5 Program 6 Program 7 Program 8 Program 9 Program 1 def aStarAlgo(start_node, stop_node): open_set = set([start_node]) closed_set = set() g = {start_node: 0} parents = {start_node: start_node} while len(open_set) \u003e 0: n = None for v in open_set: if n is None or g[v] + heuristic(v) \u003c g[n] + heuristic(n): n = v if n == stop_node or Graph_nodes[n] is None: pass else: for (m, weight) in get_neighbors(n): if m not in open_set and m not in closed_set: open_set.add(m) parents[m] = n g[m] = g[n] + weight else: if g[m] \u003e g[n] + weight: g[m] = g[n] + weight parents[m] = n if m in closed_set: closed_set.remove(m) open_set.add(m) if n is None: print('Path does not exist!') return None if n == stop_node: path = [] while parents[n] != n: path.append(n) n = parents[n] path.append(start_node) path.reverse() print('Path found: {}'.format(path)) return path open_set.remove(n) closed_set.add(n) print('Path does not exist!') return None def get_neighbors(v): if v in Graph_nodes: return Graph_nodes[v] else: return None def heuristic(n): H_dist = { 'S': 11.5, 'A': 10.1, 'B': 5.8, 'C': 3.4, 'D': 9.2, 'E': 7.1, 'F': 3.5, 'G': 0 } return H_dist[n] Graph_nodes = { 'S': [('A', 3), ('D', 4)], 'A': [('B', 4), ('D', 5)], 'B': [('C', 4), ('E', 5)], 'C': [], 'D': [('A', 5), ('E', 2)], 'E': [('B', 5), ('F', 4)], 'F': [('G', 3.5)], 'G': [] } aStarAlgo('S', 'G') aStarAlgo('A', 'B') aStarAlgo('B', 'S') Program-2 class Graph: def __init__(self, graph, heuristicNodeList, startNode): self.graph = graph self.H = heuristicNodeList self.start = startNode self.parent = {} self.status = {} self.solutionGraph = {} def applyAOStar(self): self.aoStar(self.start, False) def getNeighbors(self, v): return self.graph.get(v, '') def getStatus(self, v): return self.status.get(v, 0) def setStatus(self, v, val): self.status[v] = val def getHeuristicNodeValue(self, n): return self.H.get(n, 0) def setHeuristicNodeValue(self, n, value): self.H[n] = value def printSolution(self): print(\"FOR GRAPH SOLUTION, TRAVERSE THE GRAPH FROM THE START NODE:\", self.start) print(\"------------------------------------------------------------\") print(self.solutionGraph) print(\"------------------------------------------------------------\") def computeMinimumCostChildNodes(self, v): minimumCost = 0 costToChildNodeListDict = {} costToChildNodeListDict[minimumCost] = [] flag = True for nodeInfoTupleList in self.getNeighbors(v): cost = 0 nodeList = [] for c, weight in nodeInfoTupleList: cost = cost + self.getHeuristicNodeValue(c) + weight nodeList.append(c) if flag == True: minimumCost = cost costToChildNodeListDict[minimumCost] = nodeList flag = False else: if minimumCost \u003e cost: minimumCost = cost costToChildNodeListDict[minimumCost] = nodeList return minimumCost, costToChildNodeListDict[minimumCost] def aoStar(self, v, backTracking): print(\"HEURISTIC VALUES :\", self.H) print(\"SOLUTION GRAPH :\", self.solutionGraph) print(\"PROCESSING NODE :\", v) print(\"--------------------------------------------------------------------\") if self.getStatus(v) \u003e= 0: minimumCost, childNodeList = self.computeMinimumCostChildNodes(v) self.setHeuristicNodeValue(v, minimumCost) self.setStatus(v, len(childNodeList)) solved = True for childNode in childNodeList: self.parent[childNode] = v if self.getStatus(childNode) != -1: solved = solved \u0026 False if solved == True: self.setStatus(v, -1) self.solutionGraph[v] = childNodeList if v != self.start: self.aoStar(self.parent[v], True) if backTracking == False: for childNode in childNodeList: self.setStatus(childNode, 0) self.aoStar(childNode, False) h1 = {'A': 1, 'B': 6, 'C': 2, 'D': 12, 'E': 2, 'F': 1, 'G': 5, 'H': 7, 'I': 7, 'J': 1, 'T': 3} graph1 = { 'A': [[('B', 1), ('C', 1)], [('D', 1)]], 'B': [[('G', 1)], [('H', 1)]], 'C': [[('J', 1)]], 'D': [[('E', 1), ('F', 1)]], 'G': [[('I', 1)]] } G1 = Graph(graph1, h1, 'A') G1.applyAOStar() G1.printSolution() h2 = {'A': 1, 'B': 6, 'C': 12, 'D': 10, 'E': 4, 'F': 4, 'G': 5, 'H': 7} graph2 = { 'A': [[('B', 1), ('C', 1)], [('D', 1)]], 'B': [[('G', 1)], [('H', 1)]], 'D': [[('E', 1), ('F', 1)]] } G2 = Graph(graph2, h2, 'A') G2.applyAOStar() G2.printSolution() Program 3 import numpy as np import pandas as pd data = pd.read_csv('enjoysport.csv') concepts = np.array(data.iloc[:, 0:-1]) print(concepts) target = np.array(data.iloc[:, -1]) print(target) def learn(concepts, target): specific_h = concepts[0].copy() print('Initialization of specific_h and general_h') print(specific_h) general_h = [['?' for i in range(len(specific_h))] for i in range(len(specific_h))] print(general_h) for i, h in enumerate(concepts): if target[i] == 'yes': for x in range(len(specific_h)): if h[x] != specific_h[x]: specific_h[x] = '?' general_h[x][x] = '?' print(specific_h) print(general_h) if target[i] == 'no': for x in range(len(specific_h)): if h[x] != specific_h[x]: general_h[x][x] = specific_h[x] else: general_h[x][x] = '?' print('Steps of Candidate Elimination Algorithm', i + 1) print(specific_h) print(general_h) indices = [i for i, val in enumerate(general_h) if val == ['?', '?', '?', '?', '?', '?']] for i in indices: general_h.remove(['?', '?', '?', '?', '?', '?']) return specific_h, general_h s_final, g_final = learn(concepts, target) print('---------------- Final Answer ----------------\\n') print('Final specific_h:', s_final, sep='\\n') print('Final general_h:', g_final, sep='\\n') Program 4 import math import pandas as pd from pprint import pprint from collections import Counter def entropy(probs): return sum([-prob * math.log(prob, 2) for prob in probs]) def entropy_list(a_list): cnt = Counter(x for x in a_list) num_instance = len(a_list) * 1.0 probs = [x / num_instance for x in cnt.values()] return entropy(probs) def info_gain(df, split, target, trace=0): df_split = df.groupby(split) nobs = len(df.index) * 1.0 df_agg_ent = df_split.agg({target: [entropy_list, lambda x: len(x) / nobs]}) df_agg_ent.columns = [\"entropy\", \"propObserved\"] new_entropy = sum(df_agg_ent[\"entropy\"] * df_agg_ent[\"propObserved\"]) old_entropy = entropy_list(df[target]) return old_entropy - new_entropy def id3(df, target, attribute_name, default_class=None): cnt = Counter(x for x in df[target]) if len(cnt) == 1: return next(iter(cnt)) elif df.empty or (not attribute_name): return default_class else: default_class = max(cnt.keys()) gains = [info_gain(df, attr, target) for attr in attribute_name] index_max = gains.index(max(gains)) best_attr = attribute_name[index_max] tree = {best_attr: {}} remaining_attr = [x for x in attribute_name if x != best_attr] for attr_val, data_subset in df.groupby(best_attr): subtree = id3(data_subset, target, remaining_attr, default_class) tree[best_attr][attr_val] = subtree return tree def classify(instance, tree, default=None): attribute = next(iter(tree)) if instance[attribute] in tree[attribute].keys(): result = tree[attribute][instance[attribute]] if isinstance(result, dict): return classify(instance, result) else: return result else: return default df_tennis = pd.read_csv('id3.csv') print(df_tennis) attribute_names = list(df_tennis.columns) attribute_names.remove('PlayTennis') tree = id3(df_tennis, 'PlayTennis', attribute_names) print('\\n\\n The resultant decision tree is: \\n\\n') pprint(tree) Program 5 import numpy as np inputNeurons = 2 hiddenLayerNeurons = 2 outputNeurons = 2 inputValues = np.random.randint(1, 100, inputNeurons) outputValues = np.array([5.0, 10.0]) hiddenLayer = np.random.rand(1, hiddenLayerNeurons) hiddenBias = np.random.rand(1, hiddenLayerNeurons) outputBias = np.random.rand(1, outputNeurons) hiddenWeights = np.random.rand(inputNeurons, hiddenLayerNeurons) outputWeights = np.random.rand(hiddenLayerNeurons, outputNeurons) def sigmoid(layer): return 1 / (1 + np.exp(-layer)) def gradient(layer): return layer * (1 - layer) for i in range(50): hiddenLayer = np.dot(inputValues, hiddenWeights) hiddenLayer = sigmoid(hiddenLayer + hiddenBias) outputLayer = np.dot(hiddenLayer, outputWeights) outputLayer = sigmoid(outputLayer + outputBias) error = (outputValues - outputLayer) gradientOutputLayer = gradient(outputLayer) errorTermsOutput = gradientOutputLayer * error errorTermsHidden = gradient(hiddenLayer) * np.dot(errorTermsOutput, outputWeights.T) gradientHiddenWeights = np.dot(inputValues.reshape(inputNeurons, 1), errorTermsHidden.reshape(1, hiddenLayerNeurons)) gradientOutputWeights = np.dot(hiddenLayer.reshape(hiddenLayerNeurons, 1), errorTermsOutput.reshape(1, outputNeurons)) hiddenWeights = hiddenWeights + 0.05 * gradientHiddenWeights outputWeights = outputWeights + 0.05 * gradientOutputWeights print(\"**********************\") print(\"iteration:\", i, \"::::\", error) print(\"#####output######\", outputLayer) Program 6 import pandas as pd from sklearn.preprocessing import LabelEncoder from sklearn.naive_bayes import GaussianNB from sklearn.model_selection import train_test_split from sklearn.metrics import accuracy_score # Load Data from CSV data = pd.read_csv('id3.csv') print(\"The first 5 Values of data is :\\n\", data.head()) # Obtain train data and train output X = data.iloc[:, :-1] print(\"\\nThe First 5 values of the train data is\\n\", X.head()) y = data.iloc[:, -1] print(\"\\nThe First 5 values of train output is\\n\", y.head()) # Convert them to numbers le_outlook = LabelEncoder() X.Outlook = le_outlook.fit_transform(X.Outlook) le_Temperature = LabelEncoder() X.Temperature = le_Temperature.fit_transform(X.Temperature) le_Humidity = LabelEncoder() X.Humidity = le_Humidity.fit_transform(X.Humidity) le_Wind = LabelEncoder() X.Wind = le_Wind.fit_transform(X.Wind) print(\"\\nNow the Train data is\\n\", X.head()) le_PlayTennis = LabelEncoder() y = le_PlayTennis.fit_transform(y) print(\"\\nNow the Train output is\\n\", y) # Split the data into training and testing sets X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.25) # Create and train the Na√Øve Bayes Classifier classifier = GaussianNB() classifier.fit(X_train, y_train) # Predict and evaluate the model predicted = classifier.predict(X_test) predictTestData = classifier.predict([[1, 0, 1, 0]]) print(\"Accuracy is:\", accuracy_score(predicted, y_test)) print(\"Predicted Value for individual Test Data:\", predictTestData) Program 7 from sklearn import datasets from sklearn import metrics from sklearn.cluster import KMeans from sklearn.model_selection import train_test_split from sklearn.mixture import GaussianMixture # Load the Iris dataset iris = datasets.load_iris() # Split the data into training and testing sets X_train, X_test, y_train, y_test = train_test_split(iris.data, iris.target) # K-Means Clustering kmeans_model = KMeans(n_clusters=3) kmeans_model.fit(X_train, y_train) kmeans_score = metrics.accuracy_score(y_test, kmeans_model.predict(X_test)) print('K-Means Accuracy:', kmeans_score) # Expectation and Maximization (EM) Algorithm em_model = GaussianMixture(n_components=3) em_model.fit(X_train, y_train) em_score = metrics.accuracy_score(y_test, em_model.predict(X_test)) print('EM Algorithm Accuracy:', em_score) Program 8 from sklearn.model_selection import train_test_split from sklearn.neighbors import KNeighborsClassifier from sklearn import datasets iris = datasets.load_iris() print(\"Iris Data set loaded...\") x_train, x_test, y_train, y_test = train_test_split(iris.data, iris.target, test_size=0.1) # random_state=0 for i in range(len(iris.target_names)): print(\"Label\", i, \"-\", str(iris.target_names[i])) classifier = KNeighborsClassifier(n_neighbors=5) classifier.fit(x_train, y_train) y_pred = classifier.predict(x_test) print(\"Results of Classification using K-nn with K=5 \") for r in range(0, len(x_test)): print(\" Sample:\", str(x_test[r]), \" Actual-label:\", str(y_test[r]), \" Predicted label:\", str(y_pred[r])) print(\"Classification Accuracy:\", classifier.score(x_test, y_test)) Program 9 import numpy as np import matplotlib.pyplot as plt x = np.linspace(-5, 5, 1000) y = np.log(np.abs((x ** 2) - 1) + 0.5) x = x + np.random.normal(scale=0.05, size=1000) plt.scatter(x, y, alpha=0.3) def local_regression(x0, x, y, tau): x0 = np.r_[1, x0] x = np.c_[np.ones(len(x)), x] xw = x.T * radial_kernel(x0, x, tau) # beta = np.linalg.pinv(xw @ x) @ xw @ y return x0 @ beta def radial_kernel(x0, x, tau): return np.exp(np.sum((x - x0) ** 2, axis=1) / (-2 * tau ** 2)) def plot_lr(tau): domain = np.linspace(-5, 5, num=500) pred = [local_regression(x0, x, y, tau) for x0 in domain] plt.scatter(x, y, alpha=0.3) plt.plot(domain, pred, color=\"red\") return plt # Assuming you define beta somewhere before calling local_regression beta = np.array([0, 0]) # Placeholder value, you need to replace it with the actual beta values plot_lr(1).show() ",
  "wordCount" : "1520",
  "inLanguage": "en",
  "datePublished": "0001-01-01T00:00:00Z",
  "dateModified": "0001-01-01T00:00:00Z",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://shashankmcode.github.io/blog/docs/lab/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "SHASHANK",
    "logo": {
      "@type": "ImageObject",
      "url": "https://shashankmcode.github.io/blog/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://shashankmcode.github.io/blog/" accesskey="h" title="SHASHANK (Alt + H)">SHASHANK</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title">
      lab program(temporary post)
    </h1>
    <div class="post-meta">

</div>
  </header> 
  <div class="post-content"><h1 id="table-of-contents">Table of Contents<a hidden class="anchor" aria-hidden="true" href="#table-of-contents">#</a></h1>
<ol>
<li><a href="#program-1">Program 1</a></li>
<li><a href="#program-2">Program 2</a></li>
<li><a href="#program-3">Program 3</a></li>
<li><a href="#program-4">Program 4</a></li>
<li><a href="#program-5">Program 5</a></li>
<li><a href="#program-6">Program 6</a></li>
<li><a href="#program-7">Program 7</a></li>
<li><a href="#program-8">Program 8</a></li>
<li><a href="#program-9">Program 9</a></li>
</ol>
<h1 id="program-1">Program 1<a hidden class="anchor" aria-hidden="true" href="#program-1">#</a></h1>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">aStarAlgo</span>(start_node, stop_node):
</span></span><span style="display:flex;"><span>    open_set <span style="color:#f92672">=</span> set([start_node])
</span></span><span style="display:flex;"><span>    closed_set <span style="color:#f92672">=</span> set()
</span></span><span style="display:flex;"><span>    g <span style="color:#f92672">=</span> {start_node: <span style="color:#ae81ff">0</span>}
</span></span><span style="display:flex;"><span>    parents <span style="color:#f92672">=</span> {start_node: start_node}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> len(open_set) <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span>:
</span></span><span style="display:flex;"><span>        n <span style="color:#f92672">=</span> <span style="color:#66d9ef">None</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> v <span style="color:#f92672">in</span> open_set:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> n <span style="color:#f92672">is</span> <span style="color:#66d9ef">None</span> <span style="color:#f92672">or</span> g[v] <span style="color:#f92672">+</span> heuristic(v) <span style="color:#f92672">&lt;</span> g[n] <span style="color:#f92672">+</span> heuristic(n):
</span></span><span style="display:flex;"><span>                n <span style="color:#f92672">=</span> v
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> n <span style="color:#f92672">==</span> stop_node <span style="color:#f92672">or</span> Graph_nodes[n] <span style="color:#f92672">is</span> <span style="color:#66d9ef">None</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">pass</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (m, weight) <span style="color:#f92672">in</span> get_neighbors(n):
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> m <span style="color:#f92672">not</span> <span style="color:#f92672">in</span> open_set <span style="color:#f92672">and</span> m <span style="color:#f92672">not</span> <span style="color:#f92672">in</span> closed_set:
</span></span><span style="display:flex;"><span>                    open_set<span style="color:#f92672">.</span>add(m)
</span></span><span style="display:flex;"><span>                    parents[m] <span style="color:#f92672">=</span> n
</span></span><span style="display:flex;"><span>                    g[m] <span style="color:#f92672">=</span> g[n] <span style="color:#f92672">+</span> weight
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">if</span> g[m] <span style="color:#f92672">&gt;</span> g[n] <span style="color:#f92672">+</span> weight:
</span></span><span style="display:flex;"><span>                        g[m] <span style="color:#f92672">=</span> g[n] <span style="color:#f92672">+</span> weight
</span></span><span style="display:flex;"><span>                        parents[m] <span style="color:#f92672">=</span> n
</span></span><span style="display:flex;"><span>                        <span style="color:#66d9ef">if</span> m <span style="color:#f92672">in</span> closed_set:
</span></span><span style="display:flex;"><span>                            closed_set<span style="color:#f92672">.</span>remove(m)
</span></span><span style="display:flex;"><span>                            open_set<span style="color:#f92672">.</span>add(m)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> n <span style="color:#f92672">is</span> <span style="color:#66d9ef">None</span>:
</span></span><span style="display:flex;"><span>            print(<span style="color:#e6db74">&#39;Path does not exist!&#39;</span>)
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">None</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> n <span style="color:#f92672">==</span> stop_node:
</span></span><span style="display:flex;"><span>            path <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">while</span> parents[n] <span style="color:#f92672">!=</span> n:
</span></span><span style="display:flex;"><span>                path<span style="color:#f92672">.</span>append(n)
</span></span><span style="display:flex;"><span>                n <span style="color:#f92672">=</span> parents[n]
</span></span><span style="display:flex;"><span>            path<span style="color:#f92672">.</span>append(start_node)
</span></span><span style="display:flex;"><span>            path<span style="color:#f92672">.</span>reverse()
</span></span><span style="display:flex;"><span>            print(<span style="color:#e6db74">&#39;Path found: </span><span style="color:#e6db74">{}</span><span style="color:#e6db74">&#39;</span><span style="color:#f92672">.</span>format(path))
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> path
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        open_set<span style="color:#f92672">.</span>remove(n)
</span></span><span style="display:flex;"><span>        closed_set<span style="color:#f92672">.</span>add(n)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#39;Path does not exist!&#39;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">None</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get_neighbors</span>(v):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> v <span style="color:#f92672">in</span> Graph_nodes:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> Graph_nodes[v]
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">None</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">heuristic</span>(n):
</span></span><span style="display:flex;"><span>    H_dist <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#39;S&#39;</span>: <span style="color:#ae81ff">11.5</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#39;A&#39;</span>: <span style="color:#ae81ff">10.1</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#39;B&#39;</span>: <span style="color:#ae81ff">5.8</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#39;C&#39;</span>: <span style="color:#ae81ff">3.4</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#39;D&#39;</span>: <span style="color:#ae81ff">9.2</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#39;E&#39;</span>: <span style="color:#ae81ff">7.1</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#39;F&#39;</span>: <span style="color:#ae81ff">3.5</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#39;G&#39;</span>: <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> H_dist[n]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Graph_nodes <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;S&#39;</span>: [(<span style="color:#e6db74">&#39;A&#39;</span>, <span style="color:#ae81ff">3</span>), (<span style="color:#e6db74">&#39;D&#39;</span>, <span style="color:#ae81ff">4</span>)],
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;A&#39;</span>: [(<span style="color:#e6db74">&#39;B&#39;</span>, <span style="color:#ae81ff">4</span>), (<span style="color:#e6db74">&#39;D&#39;</span>, <span style="color:#ae81ff">5</span>)],
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;B&#39;</span>: [(<span style="color:#e6db74">&#39;C&#39;</span>, <span style="color:#ae81ff">4</span>), (<span style="color:#e6db74">&#39;E&#39;</span>, <span style="color:#ae81ff">5</span>)],
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;C&#39;</span>: [],
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;D&#39;</span>: [(<span style="color:#e6db74">&#39;A&#39;</span>, <span style="color:#ae81ff">5</span>), (<span style="color:#e6db74">&#39;E&#39;</span>, <span style="color:#ae81ff">2</span>)],
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;E&#39;</span>: [(<span style="color:#e6db74">&#39;B&#39;</span>, <span style="color:#ae81ff">5</span>), (<span style="color:#e6db74">&#39;F&#39;</span>, <span style="color:#ae81ff">4</span>)],
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;F&#39;</span>: [(<span style="color:#e6db74">&#39;G&#39;</span>, <span style="color:#ae81ff">3.5</span>)],
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;G&#39;</span>: []
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>aStarAlgo(<span style="color:#e6db74">&#39;S&#39;</span>, <span style="color:#e6db74">&#39;G&#39;</span>)
</span></span><span style="display:flex;"><span>aStarAlgo(<span style="color:#e6db74">&#39;A&#39;</span>, <span style="color:#e6db74">&#39;B&#39;</span>)
</span></span><span style="display:flex;"><span>aStarAlgo(<span style="color:#e6db74">&#39;B&#39;</span>, <span style="color:#e6db74">&#39;S&#39;</span>)
</span></span></code></pre></div><h2 id="program-2">Program-2<a hidden class="anchor" aria-hidden="true" href="#program-2">#</a></h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Graph</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __init__(self, graph, heuristicNodeList, startNode):
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>graph <span style="color:#f92672">=</span> graph
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>H <span style="color:#f92672">=</span> heuristicNodeList
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>start <span style="color:#f92672">=</span> startNode
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>parent <span style="color:#f92672">=</span> {}
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>status <span style="color:#f92672">=</span> {}
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>solutionGraph <span style="color:#f92672">=</span> {}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">applyAOStar</span>(self):
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>aoStar(self<span style="color:#f92672">.</span>start, <span style="color:#66d9ef">False</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">getNeighbors</span>(self, v):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> self<span style="color:#f92672">.</span>graph<span style="color:#f92672">.</span>get(v, <span style="color:#e6db74">&#39;&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">getStatus</span>(self, v):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> self<span style="color:#f92672">.</span>status<span style="color:#f92672">.</span>get(v, <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">setStatus</span>(self, v, val):
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>status[v] <span style="color:#f92672">=</span> val
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">getHeuristicNodeValue</span>(self, n):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> self<span style="color:#f92672">.</span>H<span style="color:#f92672">.</span>get(n, <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">setHeuristicNodeValue</span>(self, n, value):
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>H[n] <span style="color:#f92672">=</span> value
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">printSolution</span>(self):
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#34;FOR GRAPH SOLUTION, TRAVERSE THE GRAPH FROM THE START NODE:&#34;</span>, self<span style="color:#f92672">.</span>start)
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#34;------------------------------------------------------------&#34;</span>)
</span></span><span style="display:flex;"><span>        print(self<span style="color:#f92672">.</span>solutionGraph)
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#34;------------------------------------------------------------&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">computeMinimumCostChildNodes</span>(self, v):
</span></span><span style="display:flex;"><span>        minimumCost <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>        costToChildNodeListDict <span style="color:#f92672">=</span> {}
</span></span><span style="display:flex;"><span>        costToChildNodeListDict[minimumCost] <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>        flag <span style="color:#f92672">=</span> <span style="color:#66d9ef">True</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> nodeInfoTupleList <span style="color:#f92672">in</span> self<span style="color:#f92672">.</span>getNeighbors(v):
</span></span><span style="display:flex;"><span>            cost <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>            nodeList <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> c, weight <span style="color:#f92672">in</span> nodeInfoTupleList:
</span></span><span style="display:flex;"><span>                cost <span style="color:#f92672">=</span> cost <span style="color:#f92672">+</span> self<span style="color:#f92672">.</span>getHeuristicNodeValue(c) <span style="color:#f92672">+</span> weight
</span></span><span style="display:flex;"><span>                nodeList<span style="color:#f92672">.</span>append(c)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> flag <span style="color:#f92672">==</span> <span style="color:#66d9ef">True</span>:
</span></span><span style="display:flex;"><span>                minimumCost <span style="color:#f92672">=</span> cost
</span></span><span style="display:flex;"><span>                costToChildNodeListDict[minimumCost] <span style="color:#f92672">=</span> nodeList
</span></span><span style="display:flex;"><span>                flag <span style="color:#f92672">=</span> <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> minimumCost <span style="color:#f92672">&gt;</span> cost:
</span></span><span style="display:flex;"><span>                    minimumCost <span style="color:#f92672">=</span> cost
</span></span><span style="display:flex;"><span>                    costToChildNodeListDict[minimumCost] <span style="color:#f92672">=</span> nodeList
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> minimumCost, costToChildNodeListDict[minimumCost]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">aoStar</span>(self, v, backTracking):
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#34;HEURISTIC VALUES :&#34;</span>, self<span style="color:#f92672">.</span>H)
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#34;SOLUTION GRAPH :&#34;</span>, self<span style="color:#f92672">.</span>solutionGraph)
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#34;PROCESSING NODE :&#34;</span>, v)
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#34;--------------------------------------------------------------------&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> self<span style="color:#f92672">.</span>getStatus(v) <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">0</span>:
</span></span><span style="display:flex;"><span>            minimumCost, childNodeList <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>computeMinimumCostChildNodes(v)
</span></span><span style="display:flex;"><span>            self<span style="color:#f92672">.</span>setHeuristicNodeValue(v, minimumCost)
</span></span><span style="display:flex;"><span>            self<span style="color:#f92672">.</span>setStatus(v, len(childNodeList))
</span></span><span style="display:flex;"><span>            solved <span style="color:#f92672">=</span> <span style="color:#66d9ef">True</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> childNode <span style="color:#f92672">in</span> childNodeList:
</span></span><span style="display:flex;"><span>                self<span style="color:#f92672">.</span>parent[childNode] <span style="color:#f92672">=</span> v
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> self<span style="color:#f92672">.</span>getStatus(childNode) <span style="color:#f92672">!=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>:
</span></span><span style="display:flex;"><span>                    solved <span style="color:#f92672">=</span> solved <span style="color:#f92672">&amp;</span> <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> solved <span style="color:#f92672">==</span> <span style="color:#66d9ef">True</span>:
</span></span><span style="display:flex;"><span>                self<span style="color:#f92672">.</span>setStatus(v, <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>                self<span style="color:#f92672">.</span>solutionGraph[v] <span style="color:#f92672">=</span> childNodeList
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> v <span style="color:#f92672">!=</span> self<span style="color:#f92672">.</span>start:
</span></span><span style="display:flex;"><span>                    self<span style="color:#f92672">.</span>aoStar(self<span style="color:#f92672">.</span>parent[v], <span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> backTracking <span style="color:#f92672">==</span> <span style="color:#66d9ef">False</span>:
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">for</span> childNode <span style="color:#f92672">in</span> childNodeList:
</span></span><span style="display:flex;"><span>                    self<span style="color:#f92672">.</span>setStatus(childNode, <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>                self<span style="color:#f92672">.</span>aoStar(childNode, <span style="color:#66d9ef">False</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>h1 <span style="color:#f92672">=</span> {<span style="color:#e6db74">&#39;A&#39;</span>: <span style="color:#ae81ff">1</span>, <span style="color:#e6db74">&#39;B&#39;</span>: <span style="color:#ae81ff">6</span>, <span style="color:#e6db74">&#39;C&#39;</span>: <span style="color:#ae81ff">2</span>, <span style="color:#e6db74">&#39;D&#39;</span>: <span style="color:#ae81ff">12</span>, <span style="color:#e6db74">&#39;E&#39;</span>: <span style="color:#ae81ff">2</span>, <span style="color:#e6db74">&#39;F&#39;</span>: <span style="color:#ae81ff">1</span>, <span style="color:#e6db74">&#39;G&#39;</span>: <span style="color:#ae81ff">5</span>, <span style="color:#e6db74">&#39;H&#39;</span>: <span style="color:#ae81ff">7</span>, <span style="color:#e6db74">&#39;I&#39;</span>: <span style="color:#ae81ff">7</span>, <span style="color:#e6db74">&#39;J&#39;</span>: <span style="color:#ae81ff">1</span>, <span style="color:#e6db74">&#39;T&#39;</span>: <span style="color:#ae81ff">3</span>}
</span></span><span style="display:flex;"><span>graph1 <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;A&#39;</span>: [[(<span style="color:#e6db74">&#39;B&#39;</span>, <span style="color:#ae81ff">1</span>), (<span style="color:#e6db74">&#39;C&#39;</span>, <span style="color:#ae81ff">1</span>)], [(<span style="color:#e6db74">&#39;D&#39;</span>, <span style="color:#ae81ff">1</span>)]],
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;B&#39;</span>: [[(<span style="color:#e6db74">&#39;G&#39;</span>, <span style="color:#ae81ff">1</span>)], [(<span style="color:#e6db74">&#39;H&#39;</span>, <span style="color:#ae81ff">1</span>)]],
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;C&#39;</span>: [[(<span style="color:#e6db74">&#39;J&#39;</span>, <span style="color:#ae81ff">1</span>)]],
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;D&#39;</span>: [[(<span style="color:#e6db74">&#39;E&#39;</span>, <span style="color:#ae81ff">1</span>), (<span style="color:#e6db74">&#39;F&#39;</span>, <span style="color:#ae81ff">1</span>)]],
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;G&#39;</span>: [[(<span style="color:#e6db74">&#39;I&#39;</span>, <span style="color:#ae81ff">1</span>)]]
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>G1 <span style="color:#f92672">=</span> Graph(graph1, h1, <span style="color:#e6db74">&#39;A&#39;</span>)
</span></span><span style="display:flex;"><span>G1<span style="color:#f92672">.</span>applyAOStar()
</span></span><span style="display:flex;"><span>G1<span style="color:#f92672">.</span>printSolution()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>h2 <span style="color:#f92672">=</span> {<span style="color:#e6db74">&#39;A&#39;</span>: <span style="color:#ae81ff">1</span>, <span style="color:#e6db74">&#39;B&#39;</span>: <span style="color:#ae81ff">6</span>, <span style="color:#e6db74">&#39;C&#39;</span>: <span style="color:#ae81ff">12</span>, <span style="color:#e6db74">&#39;D&#39;</span>: <span style="color:#ae81ff">10</span>, <span style="color:#e6db74">&#39;E&#39;</span>: <span style="color:#ae81ff">4</span>, <span style="color:#e6db74">&#39;F&#39;</span>: <span style="color:#ae81ff">4</span>, <span style="color:#e6db74">&#39;G&#39;</span>: <span style="color:#ae81ff">5</span>, <span style="color:#e6db74">&#39;H&#39;</span>: <span style="color:#ae81ff">7</span>}
</span></span><span style="display:flex;"><span>graph2 <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;A&#39;</span>: [[(<span style="color:#e6db74">&#39;B&#39;</span>, <span style="color:#ae81ff">1</span>), (<span style="color:#e6db74">&#39;C&#39;</span>, <span style="color:#ae81ff">1</span>)], [(<span style="color:#e6db74">&#39;D&#39;</span>, <span style="color:#ae81ff">1</span>)]],
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;B&#39;</span>: [[(<span style="color:#e6db74">&#39;G&#39;</span>, <span style="color:#ae81ff">1</span>)], [(<span style="color:#e6db74">&#39;H&#39;</span>, <span style="color:#ae81ff">1</span>)]],
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;D&#39;</span>: [[(<span style="color:#e6db74">&#39;E&#39;</span>, <span style="color:#ae81ff">1</span>), (<span style="color:#e6db74">&#39;F&#39;</span>, <span style="color:#ae81ff">1</span>)]]
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>G2 <span style="color:#f92672">=</span> Graph(graph2, h2, <span style="color:#e6db74">&#39;A&#39;</span>)
</span></span><span style="display:flex;"><span>G2<span style="color:#f92672">.</span>applyAOStar()
</span></span><span style="display:flex;"><span>G2<span style="color:#f92672">.</span>printSolution()
</span></span></code></pre></div><h1 id="program-3">Program 3<a hidden class="anchor" aria-hidden="true" href="#program-3">#</a></h1>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> pandas <span style="color:#66d9ef">as</span> pd
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>data <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_csv(<span style="color:#e6db74">&#39;enjoysport.csv&#39;</span>)
</span></span><span style="display:flex;"><span>concepts <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array(data<span style="color:#f92672">.</span>iloc[:, <span style="color:#ae81ff">0</span>:<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>])
</span></span><span style="display:flex;"><span>print(concepts)
</span></span><span style="display:flex;"><span>target <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array(data<span style="color:#f92672">.</span>iloc[:, <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>])
</span></span><span style="display:flex;"><span>print(target)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">learn</span>(concepts, target):
</span></span><span style="display:flex;"><span>    specific_h <span style="color:#f92672">=</span> concepts[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">.</span>copy()
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#39;Initialization of specific_h and general_h&#39;</span>)
</span></span><span style="display:flex;"><span>    print(specific_h)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    general_h <span style="color:#f92672">=</span> [[<span style="color:#e6db74">&#39;?&#39;</span> <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(specific_h))] <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(specific_h))]
</span></span><span style="display:flex;"><span>    print(general_h)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> i, h <span style="color:#f92672">in</span> enumerate(concepts):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> target[i] <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;yes&#39;</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> range(len(specific_h)):
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> h[x] <span style="color:#f92672">!=</span> specific_h[x]:
</span></span><span style="display:flex;"><span>                    specific_h[x] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;?&#39;</span>
</span></span><span style="display:flex;"><span>                    general_h[x][x] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;?&#39;</span>
</span></span><span style="display:flex;"><span>            print(specific_h)
</span></span><span style="display:flex;"><span>            print(general_h)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> target[i] <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;no&#39;</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> range(len(specific_h)):
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> h[x] <span style="color:#f92672">!=</span> specific_h[x]:
</span></span><span style="display:flex;"><span>                    general_h[x][x] <span style="color:#f92672">=</span> specific_h[x]
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>                    general_h[x][x] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;?&#39;</span>
</span></span><span style="display:flex;"><span>            print(<span style="color:#e6db74">&#39;Steps of Candidate Elimination Algorithm&#39;</span>, i <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>            print(specific_h)
</span></span><span style="display:flex;"><span>            print(general_h)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    indices <span style="color:#f92672">=</span> [i <span style="color:#66d9ef">for</span> i, val <span style="color:#f92672">in</span> enumerate(general_h) <span style="color:#66d9ef">if</span> val <span style="color:#f92672">==</span> [<span style="color:#e6db74">&#39;?&#39;</span>, <span style="color:#e6db74">&#39;?&#39;</span>, <span style="color:#e6db74">&#39;?&#39;</span>, <span style="color:#e6db74">&#39;?&#39;</span>, <span style="color:#e6db74">&#39;?&#39;</span>, <span style="color:#e6db74">&#39;?&#39;</span>]]
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> indices:
</span></span><span style="display:flex;"><span>        general_h<span style="color:#f92672">.</span>remove([<span style="color:#e6db74">&#39;?&#39;</span>, <span style="color:#e6db74">&#39;?&#39;</span>, <span style="color:#e6db74">&#39;?&#39;</span>, <span style="color:#e6db74">&#39;?&#39;</span>, <span style="color:#e6db74">&#39;?&#39;</span>, <span style="color:#e6db74">&#39;?&#39;</span>])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> specific_h, general_h
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>s_final, g_final <span style="color:#f92672">=</span> learn(concepts, target)
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#39;---------------- Final Answer ----------------</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span>)
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#39;Final specific_h:&#39;</span>, s_final, sep<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span>)
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#39;Final general_h:&#39;</span>, g_final, sep<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span>)
</span></span></code></pre></div><h1 id="program-4">Program 4<a hidden class="anchor" aria-hidden="true" href="#program-4">#</a></h1>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> math
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> pandas <span style="color:#66d9ef">as</span> pd
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> pprint <span style="color:#f92672">import</span> pprint
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> collections <span style="color:#f92672">import</span> Counter
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">entropy</span>(probs):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> sum([<span style="color:#f92672">-</span>prob <span style="color:#f92672">*</span> math<span style="color:#f92672">.</span>log(prob, <span style="color:#ae81ff">2</span>) <span style="color:#66d9ef">for</span> prob <span style="color:#f92672">in</span> probs])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">entropy_list</span>(a_list):
</span></span><span style="display:flex;"><span>    cnt <span style="color:#f92672">=</span> Counter(x <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> a_list)
</span></span><span style="display:flex;"><span>    num_instance <span style="color:#f92672">=</span> len(a_list) <span style="color:#f92672">*</span> <span style="color:#ae81ff">1.0</span>
</span></span><span style="display:flex;"><span>    probs <span style="color:#f92672">=</span> [x <span style="color:#f92672">/</span> num_instance <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> cnt<span style="color:#f92672">.</span>values()]
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> entropy(probs)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">info_gain</span>(df, split, target, trace<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>):
</span></span><span style="display:flex;"><span>    df_split <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>groupby(split)
</span></span><span style="display:flex;"><span>    nobs <span style="color:#f92672">=</span> len(df<span style="color:#f92672">.</span>index) <span style="color:#f92672">*</span> <span style="color:#ae81ff">1.0</span>
</span></span><span style="display:flex;"><span>    df_agg_ent <span style="color:#f92672">=</span> df_split<span style="color:#f92672">.</span>agg({target: [entropy_list, <span style="color:#66d9ef">lambda</span> x: len(x) <span style="color:#f92672">/</span> nobs]})
</span></span><span style="display:flex;"><span>    df_agg_ent<span style="color:#f92672">.</span>columns <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#34;entropy&#34;</span>, <span style="color:#e6db74">&#34;propObserved&#34;</span>]
</span></span><span style="display:flex;"><span>    new_entropy <span style="color:#f92672">=</span> sum(df_agg_ent[<span style="color:#e6db74">&#34;entropy&#34;</span>] <span style="color:#f92672">*</span> df_agg_ent[<span style="color:#e6db74">&#34;propObserved&#34;</span>])
</span></span><span style="display:flex;"><span>    old_entropy <span style="color:#f92672">=</span> entropy_list(df[target])
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> old_entropy <span style="color:#f92672">-</span> new_entropy
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">id3</span>(df, target, attribute_name, default_class<span style="color:#f92672">=</span><span style="color:#66d9ef">None</span>):
</span></span><span style="display:flex;"><span>    cnt <span style="color:#f92672">=</span> Counter(x <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> df[target])
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> len(cnt) <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> next(iter(cnt))
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elif</span> df<span style="color:#f92672">.</span>empty <span style="color:#f92672">or</span> (<span style="color:#f92672">not</span> attribute_name):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> default_class
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>        default_class <span style="color:#f92672">=</span> max(cnt<span style="color:#f92672">.</span>keys())
</span></span><span style="display:flex;"><span>        gains <span style="color:#f92672">=</span> [info_gain(df, attr, target) <span style="color:#66d9ef">for</span> attr <span style="color:#f92672">in</span> attribute_name]
</span></span><span style="display:flex;"><span>        index_max <span style="color:#f92672">=</span> gains<span style="color:#f92672">.</span>index(max(gains))
</span></span><span style="display:flex;"><span>        best_attr <span style="color:#f92672">=</span> attribute_name[index_max]
</span></span><span style="display:flex;"><span>        tree <span style="color:#f92672">=</span> {best_attr: {}}
</span></span><span style="display:flex;"><span>        remaining_attr <span style="color:#f92672">=</span> [x <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> attribute_name <span style="color:#66d9ef">if</span> x <span style="color:#f92672">!=</span> best_attr]
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> attr_val, data_subset <span style="color:#f92672">in</span> df<span style="color:#f92672">.</span>groupby(best_attr):
</span></span><span style="display:flex;"><span>            subtree <span style="color:#f92672">=</span> id3(data_subset, target, remaining_attr, default_class)
</span></span><span style="display:flex;"><span>            tree[best_attr][attr_val] <span style="color:#f92672">=</span> subtree
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> tree
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">classify</span>(instance, tree, default<span style="color:#f92672">=</span><span style="color:#66d9ef">None</span>):
</span></span><span style="display:flex;"><span>    attribute <span style="color:#f92672">=</span> next(iter(tree))
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> instance[attribute] <span style="color:#f92672">in</span> tree[attribute]<span style="color:#f92672">.</span>keys():
</span></span><span style="display:flex;"><span>        result <span style="color:#f92672">=</span> tree[attribute][instance[attribute]]
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> isinstance(result, dict):
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> classify(instance, result)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> result
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> default
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>df_tennis <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_csv(<span style="color:#e6db74">&#39;id3.csv&#39;</span>)
</span></span><span style="display:flex;"><span>print(df_tennis)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>attribute_names <span style="color:#f92672">=</span> list(df_tennis<span style="color:#f92672">.</span>columns)
</span></span><span style="display:flex;"><span>attribute_names<span style="color:#f92672">.</span>remove(<span style="color:#e6db74">&#39;PlayTennis&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>tree <span style="color:#f92672">=</span> id3(df_tennis, <span style="color:#e6db74">&#39;PlayTennis&#39;</span>, attribute_names)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\n\n</span><span style="color:#e6db74"> The resultant decision tree is: </span><span style="color:#ae81ff">\n\n</span><span style="color:#e6db74">&#39;</span>)
</span></span><span style="display:flex;"><span>pprint(tree)
</span></span></code></pre></div><h1 id="program-5">Program 5<a hidden class="anchor" aria-hidden="true" href="#program-5">#</a></h1>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>inputNeurons <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>hiddenLayerNeurons <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>outputNeurons <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>inputValues <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>randint(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">100</span>, inputNeurons)
</span></span><span style="display:flex;"><span>outputValues <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array([<span style="color:#ae81ff">5.0</span>, <span style="color:#ae81ff">10.0</span>])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>hiddenLayer <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>rand(<span style="color:#ae81ff">1</span>, hiddenLayerNeurons)
</span></span><span style="display:flex;"><span>hiddenBias <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>rand(<span style="color:#ae81ff">1</span>, hiddenLayerNeurons)
</span></span><span style="display:flex;"><span>outputBias <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>rand(<span style="color:#ae81ff">1</span>, outputNeurons)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>hiddenWeights <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>rand(inputNeurons, hiddenLayerNeurons)
</span></span><span style="display:flex;"><span>outputWeights <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>rand(hiddenLayerNeurons, outputNeurons)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">sigmoid</span>(layer):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">/</span> (<span style="color:#ae81ff">1</span> <span style="color:#f92672">+</span> np<span style="color:#f92672">.</span>exp(<span style="color:#f92672">-</span>layer))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">gradient</span>(layer):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> layer <span style="color:#f92672">*</span> (<span style="color:#ae81ff">1</span> <span style="color:#f92672">-</span> layer)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">50</span>):
</span></span><span style="display:flex;"><span>    hiddenLayer <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>dot(inputValues, hiddenWeights)
</span></span><span style="display:flex;"><span>    hiddenLayer <span style="color:#f92672">=</span> sigmoid(hiddenLayer <span style="color:#f92672">+</span> hiddenBias)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    outputLayer <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>dot(hiddenLayer, outputWeights)
</span></span><span style="display:flex;"><span>    outputLayer <span style="color:#f92672">=</span> sigmoid(outputLayer <span style="color:#f92672">+</span> outputBias)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    error <span style="color:#f92672">=</span> (outputValues <span style="color:#f92672">-</span> outputLayer)
</span></span><span style="display:flex;"><span>    gradientOutputLayer <span style="color:#f92672">=</span> gradient(outputLayer)
</span></span><span style="display:flex;"><span>    errorTermsOutput <span style="color:#f92672">=</span> gradientOutputLayer <span style="color:#f92672">*</span> error
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    errorTermsHidden <span style="color:#f92672">=</span> gradient(hiddenLayer) <span style="color:#f92672">*</span> np<span style="color:#f92672">.</span>dot(errorTermsOutput, outputWeights<span style="color:#f92672">.</span>T)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    gradientHiddenWeights <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>dot(inputValues<span style="color:#f92672">.</span>reshape(inputNeurons, <span style="color:#ae81ff">1</span>), errorTermsHidden<span style="color:#f92672">.</span>reshape(<span style="color:#ae81ff">1</span>, hiddenLayerNeurons))
</span></span><span style="display:flex;"><span>    gradientOutputWeights <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>dot(hiddenLayer<span style="color:#f92672">.</span>reshape(hiddenLayerNeurons, <span style="color:#ae81ff">1</span>), errorTermsOutput<span style="color:#f92672">.</span>reshape(<span style="color:#ae81ff">1</span>, outputNeurons))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    hiddenWeights <span style="color:#f92672">=</span> hiddenWeights <span style="color:#f92672">+</span> <span style="color:#ae81ff">0.05</span> <span style="color:#f92672">*</span> gradientHiddenWeights
</span></span><span style="display:flex;"><span>    outputWeights <span style="color:#f92672">=</span> outputWeights <span style="color:#f92672">+</span> <span style="color:#ae81ff">0.05</span> <span style="color:#f92672">*</span> gradientOutputWeights
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;**********************&#34;</span>)
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;iteration:&#34;</span>, i, <span style="color:#e6db74">&#34;::::&#34;</span>, error)
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;#####output######&#34;</span>, outputLayer)
</span></span></code></pre></div><h2 id="program-6">Program 6<a hidden class="anchor" aria-hidden="true" href="#program-6">#</a></h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> pandas <span style="color:#66d9ef">as</span> pd
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> sklearn.preprocessing <span style="color:#f92672">import</span> LabelEncoder
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> sklearn.naive_bayes <span style="color:#f92672">import</span> GaussianNB
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> sklearn.model_selection <span style="color:#f92672">import</span> train_test_split
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> sklearn.metrics <span style="color:#f92672">import</span> accuracy_score
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Load Data from CSV</span>
</span></span><span style="display:flex;"><span>data <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_csv(<span style="color:#e6db74">&#39;id3.csv&#39;</span>)
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#34;The first 5 Values of data is :</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>, data<span style="color:#f92672">.</span>head())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Obtain train data and train output</span>
</span></span><span style="display:flex;"><span>X <span style="color:#f92672">=</span> data<span style="color:#f92672">.</span>iloc[:, :<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">The First 5 values of the train data is</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>, X<span style="color:#f92672">.</span>head())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>y <span style="color:#f92672">=</span> data<span style="color:#f92672">.</span>iloc[:, <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">The First 5 values of train output is</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>, y<span style="color:#f92672">.</span>head())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Convert them to numbers</span>
</span></span><span style="display:flex;"><span>le_outlook <span style="color:#f92672">=</span> LabelEncoder()
</span></span><span style="display:flex;"><span>X<span style="color:#f92672">.</span>Outlook <span style="color:#f92672">=</span> le_outlook<span style="color:#f92672">.</span>fit_transform(X<span style="color:#f92672">.</span>Outlook)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>le_Temperature <span style="color:#f92672">=</span> LabelEncoder()
</span></span><span style="display:flex;"><span>X<span style="color:#f92672">.</span>Temperature <span style="color:#f92672">=</span> le_Temperature<span style="color:#f92672">.</span>fit_transform(X<span style="color:#f92672">.</span>Temperature)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>le_Humidity <span style="color:#f92672">=</span> LabelEncoder()
</span></span><span style="display:flex;"><span>X<span style="color:#f92672">.</span>Humidity <span style="color:#f92672">=</span> le_Humidity<span style="color:#f92672">.</span>fit_transform(X<span style="color:#f92672">.</span>Humidity)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>le_Wind <span style="color:#f92672">=</span> LabelEncoder()
</span></span><span style="display:flex;"><span>X<span style="color:#f92672">.</span>Wind <span style="color:#f92672">=</span> le_Wind<span style="color:#f92672">.</span>fit_transform(X<span style="color:#f92672">.</span>Wind)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">Now the Train data is</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>, X<span style="color:#f92672">.</span>head())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>le_PlayTennis <span style="color:#f92672">=</span> LabelEncoder()
</span></span><span style="display:flex;"><span>y <span style="color:#f92672">=</span> le_PlayTennis<span style="color:#f92672">.</span>fit_transform(y)
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">Now the Train output is</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>, y)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Split the data into training and testing sets</span>
</span></span><span style="display:flex;"><span>X_train, X_test, y_train, y_test <span style="color:#f92672">=</span> train_test_split(X, y, test_size<span style="color:#f92672">=</span><span style="color:#ae81ff">0.25</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Create and train the Na√Øve Bayes Classifier</span>
</span></span><span style="display:flex;"><span>classifier <span style="color:#f92672">=</span> GaussianNB()
</span></span><span style="display:flex;"><span>classifier<span style="color:#f92672">.</span>fit(X_train, y_train)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Predict and evaluate the model</span>
</span></span><span style="display:flex;"><span>predicted <span style="color:#f92672">=</span> classifier<span style="color:#f92672">.</span>predict(X_test)
</span></span><span style="display:flex;"><span>predictTestData <span style="color:#f92672">=</span> classifier<span style="color:#f92672">.</span>predict([[<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>]])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#34;Accuracy is:&#34;</span>, accuracy_score(predicted, y_test))
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#34;Predicted Value for individual Test Data:&#34;</span>, predictTestData)
</span></span></code></pre></div><h2 id="program-7">Program 7<a hidden class="anchor" aria-hidden="true" href="#program-7">#</a></h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> sklearn <span style="color:#f92672">import</span> datasets
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> sklearn <span style="color:#f92672">import</span> metrics
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> sklearn.cluster <span style="color:#f92672">import</span> KMeans
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> sklearn.model_selection <span style="color:#f92672">import</span> train_test_split
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> sklearn.mixture <span style="color:#f92672">import</span> GaussianMixture
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Load the Iris dataset</span>
</span></span><span style="display:flex;"><span>iris <span style="color:#f92672">=</span> datasets<span style="color:#f92672">.</span>load_iris()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Split the data into training and testing sets</span>
</span></span><span style="display:flex;"><span>X_train, X_test, y_train, y_test <span style="color:#f92672">=</span> train_test_split(iris<span style="color:#f92672">.</span>data, iris<span style="color:#f92672">.</span>target)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># K-Means Clustering</span>
</span></span><span style="display:flex;"><span>kmeans_model <span style="color:#f92672">=</span> KMeans(n_clusters<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span>)
</span></span><span style="display:flex;"><span>kmeans_model<span style="color:#f92672">.</span>fit(X_train, y_train)
</span></span><span style="display:flex;"><span>kmeans_score <span style="color:#f92672">=</span> metrics<span style="color:#f92672">.</span>accuracy_score(y_test, kmeans_model<span style="color:#f92672">.</span>predict(X_test))
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#39;K-Means Accuracy:&#39;</span>, kmeans_score)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Expectation and Maximization (EM) Algorithm</span>
</span></span><span style="display:flex;"><span>em_model <span style="color:#f92672">=</span> GaussianMixture(n_components<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span>)
</span></span><span style="display:flex;"><span>em_model<span style="color:#f92672">.</span>fit(X_train, y_train)
</span></span><span style="display:flex;"><span>em_score <span style="color:#f92672">=</span> metrics<span style="color:#f92672">.</span>accuracy_score(y_test, em_model<span style="color:#f92672">.</span>predict(X_test))
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#39;EM Algorithm Accuracy:&#39;</span>, em_score)
</span></span></code></pre></div><h2 id="program-8">Program 8<a hidden class="anchor" aria-hidden="true" href="#program-8">#</a></h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> sklearn.model_selection <span style="color:#f92672">import</span> train_test_split
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> sklearn.neighbors <span style="color:#f92672">import</span> KNeighborsClassifier
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> sklearn <span style="color:#f92672">import</span> datasets
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>iris <span style="color:#f92672">=</span> datasets<span style="color:#f92672">.</span>load_iris()
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#34;Iris Data set loaded...&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>x_train, x_test, y_train, y_test <span style="color:#f92672">=</span> train_test_split(iris<span style="color:#f92672">.</span>data, iris<span style="color:#f92672">.</span>target, test_size<span style="color:#f92672">=</span><span style="color:#ae81ff">0.1</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e"># random_state=0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(iris<span style="color:#f92672">.</span>target_names)):
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;Label&#34;</span>, i, <span style="color:#e6db74">&#34;-&#34;</span>, str(iris<span style="color:#f92672">.</span>target_names[i]))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>classifier <span style="color:#f92672">=</span> KNeighborsClassifier(n_neighbors<span style="color:#f92672">=</span><span style="color:#ae81ff">5</span>)
</span></span><span style="display:flex;"><span>classifier<span style="color:#f92672">.</span>fit(x_train, y_train)
</span></span><span style="display:flex;"><span>y_pred <span style="color:#f92672">=</span> classifier<span style="color:#f92672">.</span>predict(x_test)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#34;Results of Classification using K-nn with K=5 &#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> r <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">0</span>, len(x_test)):
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34; Sample:&#34;</span>, str(x_test[r]), <span style="color:#e6db74">&#34; Actual-label:&#34;</span>, str(y_test[r]), <span style="color:#e6db74">&#34; Predicted label:&#34;</span>, str(y_pred[r]))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#34;Classification Accuracy:&#34;</span>, classifier<span style="color:#f92672">.</span>score(x_test, y_test))
</span></span></code></pre></div><h2 id="program-9">Program 9<a hidden class="anchor" aria-hidden="true" href="#program-9">#</a></h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#66d9ef">as</span> plt
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>x <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>linspace(<span style="color:#f92672">-</span><span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">1000</span>)
</span></span><span style="display:flex;"><span>y <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>log(np<span style="color:#f92672">.</span>abs((x <span style="color:#f92672">**</span> <span style="color:#ae81ff">2</span>) <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">+</span> <span style="color:#ae81ff">0.5</span>)
</span></span><span style="display:flex;"><span>x <span style="color:#f92672">=</span> x <span style="color:#f92672">+</span> np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>normal(scale<span style="color:#f92672">=</span><span style="color:#ae81ff">0.05</span>, size<span style="color:#f92672">=</span><span style="color:#ae81ff">1000</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>scatter(x, y, alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.3</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">local_regression</span>(x0, x, y, tau):
</span></span><span style="display:flex;"><span>    x0 <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>r_[<span style="color:#ae81ff">1</span>, x0]
</span></span><span style="display:flex;"><span>    x <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>c_[np<span style="color:#f92672">.</span>ones(len(x)), x]
</span></span><span style="display:flex;"><span>    xw <span style="color:#f92672">=</span> x<span style="color:#f92672">.</span>T <span style="color:#f92672">*</span> radial_kernel(x0, x, tau)
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># beta = np.linalg.pinv(xw @ x) @ xw @ y</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> x0 <span style="color:#f92672">@</span> beta
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">radial_kernel</span>(x0, x, tau):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> np<span style="color:#f92672">.</span>exp(np<span style="color:#f92672">.</span>sum((x <span style="color:#f92672">-</span> x0) <span style="color:#f92672">**</span> <span style="color:#ae81ff">2</span>, axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>) <span style="color:#f92672">/</span> (<span style="color:#f92672">-</span><span style="color:#ae81ff">2</span> <span style="color:#f92672">*</span> tau <span style="color:#f92672">**</span> <span style="color:#ae81ff">2</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">plot_lr</span>(tau):
</span></span><span style="display:flex;"><span>    domain <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>linspace(<span style="color:#f92672">-</span><span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">5</span>, num<span style="color:#f92672">=</span><span style="color:#ae81ff">500</span>)
</span></span><span style="display:flex;"><span>    pred <span style="color:#f92672">=</span> [local_regression(x0, x, y, tau) <span style="color:#66d9ef">for</span> x0 <span style="color:#f92672">in</span> domain]
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>scatter(x, y, alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.3</span>)
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>plot(domain, pred, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;red&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> plt
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Assuming you define beta somewhere before calling local_regression</span>
</span></span><span style="display:flex;"><span>beta <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array([<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>])  <span style="color:#75715e"># Placeholder value, you need to replace it with the actual beta values</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>plot_lr(<span style="color:#ae81ff">1</span>)<span style="color:#f92672">.</span>show()
</span></span></code></pre></div>

  </div>

  <footer class="post-footer">
    <ul class="post-tags">
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2024 <a href="https://shashankmcode.github.io/blog/">SHASHANK</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
